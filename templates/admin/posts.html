{% extends "admin/layout.html" %}

{% block content %}

<h2>Posts</h2>

<h3>Nuevo Post</h3>

<form method="POST" action="/admin/posts/create">
  <label>Texto</label><br>
  <select name="text_id">
    {% for text in texts %}
      <option value="{{ text.id }}">{{ text.content[:60] }}</option>
    {% endfor %}
  </select><br><br>

  <label>Imagenes</label><br>
  <select name="image_id">
    {% for image in images %}
      <option value="{{ image.id }}">{{ image.public_id }}</option>
    {% endfor %}
  </select><br><br>

  <label>Fecha publicacion</label>
  <input type="datetime-local" name="publish_at" required><br><br>

  <button type="submit">Crear post</button>
</form>

<hr>

<table>
  <tr>
    <th>ID</th>
    <th>Image</th>
    <th>Text</th>
    <th>Publish At</th>
    <th>Status</th>
    <th>Actions</th>
  </tr>

  {% for post in posts %}
  <tr>
    <td>{{ post.id }}</td>
    <td>
      <img src="{{ post.image.url }}" width="80">
    </td>
    <td>{{ post.text.content[:40] }}</td>
    <td>{{ post.publish_at }}</td>
    <td>{{ post.status }}</td>
    <td>
      <a href="{{ url_for('admin_posts.edit', post_id=post.id )}}">
        âœï¸ Edit
      </a>
      <form
      action="{{ url_for('admin_posts.delete', post_id=post.id) }}"
      method="POST"
      style="display: inline;"
      onsubmit="return confirm('Eliminar este post?')"
      >
        <button type="submit">ğŸ—‘ï¸ Eliminar</button>
      </form>
    </td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
